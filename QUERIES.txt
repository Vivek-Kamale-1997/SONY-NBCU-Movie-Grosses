QUERIES:	

SET A DEFAULT TERRITORY:
select * from territory;
select * from USER_INFO
WHERE USER_INFO_ID='206470221';

UPDATE USER_INFO
SET DFLT_TERRITORY_ID=14
WHERE USER_INFO_ID='206470221';

To check invoice type (Report or Individual):
select distinct(INV_DOC_TYPE_CD)  from circuit
where TERRITORY_ID=30;

select * from circuit
where TERRITORY_ID=12 and INV_DOC_TYPE_CD='R';

select * from circuit
where TERRITORY_ID=12 and INV_DOC_TYPE_CD='I';

3 main queries(India Invoicing SONY):
1]
select STG_INV_INTERFACE_INDIA_ID,DOCUMENT_NUMBER,SEND_STATUS,IS_INVOICE_GEN,ERROR_CODE,ERROR_DESC,SIGNED_QR_CODE,IRN_NUMBER
from STG_INV_INTERFACE_INDIA
where DOCUMENT_NUMBER IN (3107800,3107801);

2]
select * from  STG_INV_DETAIL_INTERFACE_INDIA
where STG_INV_INTERFACE_INDIA_ID IN (361,362);

select STG_INV_DETAIL_INTERFACE_INDIA_ID, LINE_ITEM_GROSS, LINE_ITEM_TAXABLE, LINE_ITEM_IGST_RATE,
LINE_ITEM_IGST_AMOUNT, LINE_ITEM_CGST_RATE, LINE_ITEM_CGST_AMOUNT, LINE_ITEM_SGST_RATE, LINE_ITEM_SGST_AMOUNT
from  STG_INV_DETAIL_INTERFACE_INDIA
where STG_INV_INTERFACE_INDIA_ID IN (364,365,366,367);

3]
select INVOICE_HEADER_ID,INVOICE_NO,INVOICE_DATE,FR_TAX
from VW_INVOICE_REPORT_INDIA
WHERE TERRITORY_ID=22 AND INVOICE_NO IN (3107800,3107801);

4]
Query to increase Sequence Number:
update POSTING_NUMBER
set POSTING_NUMBER=POSTING_NUMBER+5000
where territory_id=22
and POSTING_NUMBER_TYPE_CD='CN';  

update POSTING_NUMBER
set POSTING_NUMBER=POSTING_NUMBER+5000
where territory_id=22
and POSTING_NUMBER_TYPE_CD='IN';  

update POSTING_NUMBER
set POSTING_NUMBER=POSTING_NUMBER+5000
where territory_id=22
and POSTING_NUMBER_TYPE_CD='MC';

update POSTING_NUMBER
set POSTING_NUMBER=POSTING_NUMBER+5000
where territory_id=22
and POSTING_NUMBER_TYPE_CD='MI';

//nfr INVOICE
update POSTING_NUMBER
set POSTING_NUMBER=POSTING_NUMBER+5000
where territory_id=22
and POSTING_NUMBER_TYPE_CD='IN'; 

5] MANUAL UPDATE OF INVOICE GENERATION:
UPDATE STG_INV_INTERFACE_INDIA
SET IS_INVOICE_GEN='Y'
WHERE DOCUMENT_NUMBER IN (3107431);

6]
--ar summary
select BI_PER_CAPITA_AMT, BI_PER_CAPITA_AMT_USD , BI_PER_CAPITA_AMT_TER 
from  AR_SUMMARY 
where TERRITORY_ID=6 and BI_PER_CAPITA_AMT>0 AND RELEASE_ID=208781
;

--ar summary
SELECT * FROM AR_SUMMARY where TERRITORY_ID=6 and BI_PER_CAPITA_AMT>0 ;


7]maha GST:
27AAACB9318D1ZW


SELECT 
DOCUMENT_NUMBER,
IS_INVOICE_GEN,
SEND_STATUS,
ERROR_CODE,
ERROR_DESC,
CUSTOMER_GST_NUMBER,
SUPPLY_TYPE,
IRN_NUMBER,
SIGNED_QR_CODE
FROM STG_INV_INTERFACE_INDIA
where  DOCUMENT_NUMBER=3104142;

8]
select * from BILLING_ITEM
where TERRITORY_ID=22 AND INV_HEADER_ID IN (22152712,22152715,22152714);

SELECT TERRITORY_NAME_HO,VAT_LOOKUP_CD
FROM TERRITORY 
WHERE TERRITORY_ID=22;



1]all territory tax has same table:
select * from tax_group;
select * from tax_group_detail;

1) SET A DEFAULT TERRITORY:
select * from territory;

select * from USER_INFO
WHERE USER_INFO_ID='206470221';

UPDATE USER_INFO
SET DFLT_TERRITORY_ID=14
WHERE USER_INFO_ID='206470221';


2) MANUAL UPDATE OF INVOICE GENERATION:
select STG_INV_INTERFACE_INDIA_ID,DOCUMENT_NUMBER,SEND_STATUS,IS_INVOICE_GEN,ERROR_CODE,ERROR_DESC,SIGNED_QR_CODE,IRN_NUMBER
from STG_INV_INTERFACE_INDIA
where DOCUMENT_NUMBER IN (3107800,3107801);

UPDATE STG_INV_INTERFACE_INDIA
SET IS_INVOICE_GEN='Y'
WHERE DOCUMENT_NUMBER IN (3107431);

3] Finding a particular circuit:
select VAT,CIRCUIT_SHORT_NAME from circuit
where VAT like '27%' and  TERRITORY_ID=22 and STATUS_CD='A';


invoice header table(INV_HEADER)
India staging table(STG_INV_INTERFACE_INDIA)
India staging detail table(STG_INV_DETAIL_INTERFACE_INDIA)

4]Query to increase Sequence Number:
update POSTING_NUMBER
set POSTING_NUMBER=POSTING_NUMBER+500
where territory_id=22
and POSTING_NUMBER_TYPE_CD='IN';

update POSTING_NUMBER
set POSTING_NUMBER=POSTING_NUMBER+500
where territory_id=22
and POSTING_NUMBER_TYPE_CD='CN';


select DOCUMENT_NUMBER,ERROR_CODE,ERROR_DESC,IRN_NUMBER,SIGNED_QR_CODE,SEND_STATUS,IS_INVOICE_GEN
from STG_INV_INTERFACE_INDIA 
where DOCUMENT_NUMBER=3104158
order by 1 desc

VW_INVOICE_REPORT_INDIA 

--update invoice status
update STG_INV_INTERFACE_INDIA
set send_status='R'
where STG_INV_INTERFACE_INDIA_ID=1485;

--search for invoice 
select * from  STG_INV_DETAIL_INTERFACE_INDIA
where STG_INV_INTERFACE_INDIA_ID=1523 OR DOCUMENT_NUMBER=3104155
order by 1 desc;

--search for invoice 
SELECT CUSTOMER_ADDR1,CUSTOMER_ADDR2 , CUSTOMER_CITY_LOCATION ,CUSTOMER_PIN_CODE , CUSTOMER_CONTACT_PHONE, CUSTOMER_GST_NUMBER
FROM  STG_INV_INTERFACE_INDIA
WHERE DOCUMENT_NUMBER IN ('3103877' , '7000813' , '3103878') ;

--ar summary
select BI_PER_CAPITA_AMT, BI_PER_CAPITA_AMT_USD , BI_PER_CAPITA_AMT_TER 
from  AR_SUMMARY 
where TERRITORY_ID=6 and BI_PER_CAPITA_AMT>0 AND RELEASE_ID=208781
;

--ar summary
SELECT * FROM AR_SUMMARY where TERRITORY_ID=6 and BI_PER_CAPITA_AMT>0 ;

--release search
SELECT * FROM RELEASE WHERE RELEASE_DT='03-JUN-20';

--check an enception 
select * from EXCEPTION_LOG
where EXCEPTION_LOG_ID=249655;

--SAP batch job :
NOTE: .PROC_RUN_FCM_INTERFACE('AS')   : 'AS' denotes Asia
select * territory_id=?  for Spain > get the  REGION_NAME_CODE  >use it in .PROC_RUN_FCM_INTERFACE('?')

select REGION_NAME_CODE  from territory
where TERRITORY_NAME='Spain';

Syntax:
BEGIN
FCM_SAP_INTERFACE_PKG.PROC_RUN_FCM_INTERFACE(REGION_NAME_CODE);
END;

Asia:
BEGIN
FCM_SAP_INTERFACE_PKG.PROC_RUN_FCM_INTERFACE('AS');
END;

Europe/Spain:
BEGIN
FCM_SAP_INTERFACE_PKG.PROC_RUN_FCM_INTERFACE('WE');
END;

Australia:
BEGIN
FCM_SAP_INTERFACE_PKG.PROC_RUN_FCM_INTERFACE('AU');
END;